<html>
<head>
<title>WineBOX Store</title>
<style>
  body {
    font-family: 'Roboto', sans-serif;
    margin: 0;
    padding: 0;
    background-color: #141414;
    color: #ffffff;
    display: flex;
  }
  .sidebar {
    width: 100px;
    background-color: #000000;
    height: 100vh;
    position: fixed;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-top: 10px;
  }
  .sidebar-icon-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 15px;
  }
  .sidebar-icon {
    width: 30px;
    height: 30px;
    margin-bottom: 5px;
    opacity: 0.8;
    transition: transform 0.3s ease;
  }
  .sidebar-icon:hover {
    transform: scale(1.1);
  }
  .sidebar-label {
    font-size: 10px;
    color: #ffffff;
    text-align: center;
  }
  .main-content {
    margin-left: 100px;
    width: calc(100% - 100px);
  }
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
  }
  .header {
    background-color: #000000;
    padding: 20px 0;
    position: sticky;
    top: 0;
    z-index: 100;
  }
  .header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
  }
  .logo {
    font-size: 24px;
    font-weight: bold;
    color: #a0a0a0;
  }
  .search-bar {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .search-input {
    padding: 10px;
    border: none;
    border-radius: 4px;
    width: 300px;
  }
  .search-button {
    background-color: #4a4a4a;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 4px;
    cursor: pointer;
  }
  .joystick-button {
    background-color: #333;
    color: white;
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  .joystick-button.connected {
    background-color: #666;
  }
  .recent-section {
    position: relative;
    margin: 20px 0 40px;
  }
  .recent-apps-container {
    position: relative;
    padding-bottom: 30px;
  }
  .selected-app-info {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    background: linear-gradient(to right, rgba(74, 74, 74, 0.8), rgba(42, 42, 42, 0.8));
    color: white;
    padding: 8px 15px;
    border-radius: 4px;
    font-size: 14px;
    font-weight: bold;
    opacity: 0;
    transition: opacity 0.3s ease;
    box-shadow: 0 2px 10px rgba(0,0,0,0.5);
    pointer-events: none;
  }
  .recent-app.selected ~ .selected-app-info {
    opacity: 1;
  }
  .recent-apps {
    display: flex;
    gap: 15px;
    overflow-x: auto;
    scroll-behavior: smooth;
    padding-bottom: 10px;
    scrollbar-width: none;
    -ms-overflow-style: none;
  }
  .recent-apps::-webkit-scrollbar {
    display: none;
  }
  .recent-app {
    width: 160px;
    height: 160px;
    border-radius: 8px;
    object-fit: cover;
    cursor: pointer;
    transition: transform 0.2s;
    border: 2px solid transparent;
    flex-shrink: 0;
  }
  .recent-app:hover {
    transform: scale(1.1);
  }
  .recent-app.selected {
    border: 2px solid #4a4a4a;
    transform: scale(1.1);
  }
  .scroll-indicator {
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    font-size: 24px;
    width: 30px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    cursor: pointer;
    opacity: 0;
    transition: opacity 0.3s;
    z-index: 10;
  }
  .recent-apps-container:hover .scroll-indicator {
    opacity: 1;
  }
  .categories {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 20px;
    flex-wrap: wrap;
  }
  .category-button {
    background-color: #333;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 20px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  .category-button:hover, 
  .category-button.active,
  .category-button.selected {
    background-color: #666666;
  }
  .app-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 20px;
    margin-top: 20px;
  }
  .app-card {
    background-color: #2f2f2f;
    border-radius: 8px;
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor: pointer;
    position: relative;
  }
  .app-card:hover {
    transform: scale(1.05);
    box-shadow: 0 10px 20px rgba(0,0,0,0.3);
  }
  .app-card.selected {
    outline: 3px solid #4a4a4a;
    transform: scale(1.05);
    box-shadow: 0 10px 20px rgba(0,0,0,0.3);
  }
  .app-thumbnail {
    width: 100%;
    height: 200px;
    object-fit: cover;
  }
  .app-info {
    padding: 15px;
  }
  .app-title {
    font-size: 16px;
    font-weight: bold;
    margin-bottom: 5px;
  }
  .app-category {
    color: #ccc;
    margin-bottom: 5px;
  }
  .modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.9);
  }
  .modal-content {
    background-color: #181818;
    margin: 5% auto;
    padding: 20px;
    border-radius: 8px;
    max-width: 800px;
    width: 90%;
  }
  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
  }
  .close:hover,
  .close:focus {
    color: #fff;
  }
  .app-details {
    margin-top: 20px;
  }
  .action-button {
    background-color: #4a4a4a;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.3s ease;
    margin-right: 10px;
  }
  .action-button:hover, 
  .action-button.selected {
    background-color: #666666;
  }
  .joystick-dialog {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #2f2f2f;
    border-radius: 8px;
    padding: 20px;
    width: 80%;
    max-width: 600px;
    z-index: 2000;
    box-shadow: 0 5px 15px rgba(0,0,0,0.5);
  }
  .joystick-dialog h2 {
    margin-top: 0;
    color: #a0a0a0;
  }
  .joystick-status {
    margin: 15px 0;
    font-size: 16px;
  }
  .joystick-connect-btn {
    background-color: #4a4a4a;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.3s;
    margin-top: 10px;
  }
  .joystick-connect-btn:hover {
    background-color: #666666;
  }
  .joystick-close {
    position: absolute;
    top: 10px;
    right: 10px;
    color: #aaa;
    font-size: 24px;
    font-weight: bold;
    cursor: pointer;
  }
  .joystick-close:hover {
    color: #fff;
  }
  .joystick-types {
    display: none;
    margin-top: 20px;
  }
  .joystick-types h3 {
    color: #a0a0a0;
    margin-bottom: 15px;
  }
  .joystick-type-buttons {
    display: flex;
    flex-direction: column;
    gap: 10px;
    width: 40%;
    float: left;
  }
  .joystick-type-btn {
    background-color: #333;
    color: white;
    border: none;
    padding: 12px;
    border-radius: 4px;
    cursor: pointer;
    text-align: left;
    transition: background-color 0.3s;
  }
  .joystick-type-btn:hover {
    background-color: #666;
  }
  .joystick-preview {
    width: 55%;
    float: right;
    text-align: center;
    display: none;
  }
  .joystick-preview img {
    max-width: 100%;
    max-height: 300px;
    border-radius: 8px;
  }
  .clearfix::after {
    content: "";
    display: table;
    clear: both;
  }
</style>
</head>
<body>
  <div class="sidebar">
    <div class="sidebar-icon-container">
      <svg class="sidebar-icon" viewBox="0 0 24 24" fill="white">
        <path d="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z" />
      </svg>
    </div>
    <div class="sidebar-icon-container">
      <svg class="sidebar-icon" viewBox="0 0 24 24" fill="white">
        <path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" />
      </svg>
      <span class="sidebar-label">Aplicaciones</span>
    </div>
    <div class="sidebar-icon-container">
      <svg class="sidebar-icon" viewBox="0 0 24 24" fill="white">
        <path d="M21,6H3A2,2 0 0,0 1,8V16A2,2 0 0,0 3,18H21A2,2 0 0,0 23,16V8A2,2 0 0,0 21,6M21,16H3V8H21M6,15H8V13H10V11H8V9H6V11H4V13H6M14.5,12A1.5,1.5 0 0,1 16,13.5A1.5,1.5 0 0,1 14.5,15A1.5,1.5 0 0,1 13,13.5A1.5,1.5 0 0,1 14.5,12M18.5,9A1.5,1.5 0 0,1 20,10.5A1.5,1.5 0 0,1 18.5,12A1.5,1.5 0 0,1 17,10.5A1.5,1.5 0 0,1 18.5,9Z" />
      </svg>
      <span class="sidebar-label">Juegos</span>
    </div>
    <div class="sidebar-icon-container">
      <svg class="sidebar-icon" viewBox="0 0 24 24" fill="white">
        <path d="M21,16V4H3V16H21M21,2A2,2 0 0,1 23,4V16A2,2 0 0,1 21,18H14V20H16V22H8V20H10V18H3C1.89,18 1,17.1 1,16V4C1,2.89 1.89,2 3,2H21M5,6H14V11H5V6M15,6H19V8H15V6M19,9V14H15V9H19M5,12H9V14H5V12M10,12H14V14H10V12Z" />
      </svg>
      <span class="sidebar-label">Arcade</span>
    </div>
  </div>

  <div class="main-content">
    <header class="header">
      <div class="header-content">
        <div class="logo">WineBOX Store</div>
        <div class="search-bar">
          <input type="text" class="search-input" placeholder="Find apps...">
          <button class="search-button">Find</button>
          <button id="joystickButton" class="joystick-button" title="Joystick status">🎮</button>
        </div>
      </div>
    </header>

    <div class="container">
      <div class="recent-section">
        <div class="recent-title">Recently Used</div>
        <div class="recent-apps-container">
          <div class="recent-apps" id="recentApps"></div>
          <div class="scroll-indicator" id="scrollIndicator">></div>
          <div class="selected-app-info" id="selectedAppInfo"></div>
        </div>
      </div>

      <div class="categories" id="categories">
        <button class="category-button active" data-category="all">Alls</button>
        <button class="category-button" data-category="apps">Apps</button>
        <button class="category-button" data-category="games">Games</button>
        <button class="category-button" data-category="multimedia">Multimedia</button>
        <button class="category-button" data-category="utilities">Utilities</button>
        <button class="category-button" data-category="arcade">Arcade</button>
        <button class="category-button" data-category="rts">Strategy</button>
      </div>
      <div class="app-grid" id="appGrid"></div>
    </div>

    <div id="appModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <div class="app-details" id="appDetails"></div>
        <div class="app-actions">
          <button id="launchButton" class="action-button">Run</button>
        </div>
      </div>
    </div>
  </div>

  <div id="joystickDialog" class="joystick-dialog">
    <span class="joystick-close">&times;</span>
    <h2>Estado del Control</h2>
    <div class="joystick-status" id="joystickStatusText">No se detectó ningún control conectado.</div>
    <button id="connectJoystickBtn" class="joystick-connect-btn">CONECTAR MI CONTROL</button>
    <div id="joystickTypes" class="joystick-types clearfix">
      <h3>Elige tu control:</h3>
      <div class="joystick-type-buttons">
        <button class="joystick-type-btn" data-type="xbox">Xbox</button>
        <button class="joystick-type-btn" data-type="playstation">PlayStation</button>
        <button class="joystick-type-btn" data-type="amazon">Amazon</button>
        <button class="joystick-type-btn" data-type="generic">Genérico</button>
      </div>
      <div class="joystick-preview" id="joystickPreview"></div>
    </div>
  </div>

  <audio id="navSound" preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3" type="audio/mpeg">
  </audio>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const appData = [

      {
          name: "Blood",
          image: "box/blood.jpg",
          description: "Blood is a 3D first-person shooter video game developed by Monolith Productions and published by GT Interactive.",
          category: "games",
          link: "blood.html"
        },
        {
          name: "Diablo",
          image: "box/diablo.jpg",
          description: "Diablo is an action role-playing dungeon crawler video game series developed by Blizzard North and continued by Blizzard Entertainment after the North studio shut down in 2005.",
          category: "games",
          link: "diablo.html"
        },
        {
          name: "Doom",
          image: "box/doom.jpg",
          description: "*Doom* is a first-person shooter game released in 1993, developed by id Software. Players take on the role of a space marine battling hordes of demons and hellish creatures in a Martian base. It's renowned for its fast-paced action, groundbreaking graphics for its time, and for being one of the pioneers of the FPS genre.",
          category: "games",
          link: "doom.html"
        },
        {
          name: "Doom II",
          image: "box/doom2.jpg",
          description: "*Doom* is a first-person shooter game released in 1993, developed by id Software. Players take on the role of a space marine battling hordes of demons and hellish creatures in a Martian base. It's renowned for its fast-paced action, groundbreaking graphics for its time, and for being one of the pioneers of the FPS genre.",
          category: "games",
          link: "doom2.html"
        },
        {
          name: "Duke Nukem 3D",
          image: "box/duke3d.webp",
          description: "Duke Nukem 3D is a first-person shooter video game developed by 3D Realms.",
          category: "games",
          link: "duke3d.html"
        },
        {
          name: "Dune 2000",
          image: "box/dune2000.jpg",
          description: "This is recreation of the classic strategy game Dune 2000.",
          category: "rts",
          link: "dune2000.html"
        },
        {
          name: "Dune II",
          image: "box/dune2.jpg",
          description: "This is recreation of the classic strategy game Dune 2.",
          category: "rts",
          link: "dune2.html"
        },
        {
          name: "Final DOOM",
          image: "box/finaldoom.jpg",
          description: "Final Doom is a first-person shooter video game developed by TeamTNT, and Dario and Milo Casali, and was released by id Software.",
          category: "games",
          link: "finaldoom.html"
        },
        {
          name: "Grand Theft Auto",
          image: "box/gta.jpg",
          description: "Grand Theft Auto is a famous and most played DOS game that now is available to play in browser.",
          category: "games",
          link: "gta.html"
        },
        {
          name: "Heretic",
          image: "box/heretic.jpg",
          description: "Heretic: Shadow of the Serpent Riders is a dark fantasy, spellcasting, first-person shooter developed by Raven Software and published by id Software in 1994.",
          category: "games",
          link: "heretic.html"
        },
        {
          name: "Indianapolis 500: The Simulation",
          image: "box/indi.jpg",
          description: "Indianapolis 500: The Simulation is a 1989 computer game for MS-DOS. It was hailed as the first step of differentiating racing games from the arcade realm and into racing simulation.",
          category: "rts",
          link: "indi.html"
        },
        {
          name: "Media IPTV",
          image: "box/media.png",
          description: "An IPTV media player is an application that streams live TV, video-on-demand, and online channels via IPTV protocols, offering playlist support, EPG integration, and customizable viewing options.",
          category: "multimedia",
          link: "http://www.winebox.cloud/apps/hmpi/index.html"
        },
        {
          name: "Mortal Kombat",
          image: "box/mk.jpg",
          description: "Mortal Kombat is a fighting game in which players battle opponents in one-on-one matches. The player that depletes the opponent's health bar first wins",
          category: "games",
          link: "mk.html"
        },
        {
          name: "Open TTD",
          image: "box/openttd.jpg",
          description: "OpenTTD is a business simulation game in which players try to earn money by transporting passengers, minerals and goods via road, rail, water and air. It is an open-source remake and expansion of the 1995 Chris Sawyer video game Transport Tycoon Deluxe.",
          category: "rts",
          link: "openttd.html"
        },
        {
          name: "Quake",
          image: "box/quake.jpg",
          description: "Play legendary Quake game in browser without registration and ads. You can play orginal game as well as Scourge of Armagon and Dissolution of Eternity",
          category: "games",
          link: "quake.html"
        },
        {
          name: "Quarantine",
          image: "box/qua.jpg",
          description: "Quarantine is a 1994 racing/first-person shooter video game for MS-DOS and 3DO, created by Imagexcel and published by GameTek.",
          category: "games",
          link: "quarantine.html"
        },
        {
          name: "Space Quest: Chapter I - The Sarien Encounter",
          image: "box/spaceq.jpg",
          description: "Space Quest: Chapter I – The Sarien Encounter is a graphic adventure game, created by Scott Murphy and Mark Crowe.",
          category: "games",
          link: "spaceq.html"
        },
        {
          name: "Test Drive",
          image: "box/testdrive.jpg",
          description: "Test Drive is a series of racing video games that were originally published by Accolade until they were bought by Infogrames, which later turned into Atari. ",
          category: "games",
          link: "testdrive.html"
        },
        {
          name: "The Need for Speed",
          image: "box/nfs.jpg",
          description: "The Need for Speed is a 1994 racing game developed by EA Canada, originally known as Pioneer Productions, and published by Electronic Arts for 3DO. ",
          category: "games",
          link: "nfs.html"
        },
        {
          name: "Ultimate DOOM",
          image: "box/ultimate.jpg",
          description: "This is an updated release of the original DOOM called THE ULTIMATE DOOM. THE ULTIMATE DOOM was released in late 1993 which is months before DOOM II came out.",
          category: "games",
          link: "ultimatedoom.html"
        },
        {
          name: "Wolfenstein 3D",
          image: "box/wolf3d.jpg",
          description: "Wolfenstein 3D is a first-person shooter video game developed by id Software and published by Apogee Software and FormGen. ",
          category: "games",
          link: "wolf3d.html"
        },
        {
          name: "WolfenDOOM",
          image: "box/wolfdoom.jpg",
          description: "Wolfenstein 3D under the DOOM world. ",
          category: "games",
          link: "wolfdoom.html"
        },
        {
          name: "Wing Commander",
          image: "box/wing.jpg",
          description: "Wing Commander is a space flight simulation game, with the player piloting a ship, completing missions, and engaging enemy ships of various capabilities.",
          category: "games",
          link: "wing.html"
        },
        {
          name: "Youtube",
          image: "box/youtube.png",
          description: "YouTube is an online video platform that allows users to watch, upload, share, and stream content, including videos, live broadcasts, and playlists across various categories.",
          category: "multimedia",
          link: "http://www.youtube.com"
        },
        {
          name: "Youtube Music",
          image: "box/youtubemusic.png",
          description: "YouTube Music is a streaming service that offers music playback, personalized playlists, offline listening, and music video integration from YouTube’s extensive catalog.",
          category: "multimedia",
          link: "https://music.youtube.com"
        },
        {
          name: "Arachne Browser",
          image: "box/arachne.jpg",
          description: "Web Browser for MS-DOS.",
          category: "apps",
          link: "arachne.html"
        },
        {
          name: "AbiWord",
          image: "box/abiword.png",
          description: "Procesador de texto profesional.",
          category: "apps",
          link: "abiword.html"
        },
        {
          name: "Desktop",
          image: "box/dock.png",
          description: "The desktop is a graphical workspace in WineBOX that allows users to organize icons, access files, and launch applications. It serves as the main interface for managing windows, shortcuts, and system functions.",
          category: "apps",
          link: "dock.html"
        },
        {
          name: "DosBOX",
          image: "box/dosbox.png",
          description: "Run, test and install MS-DOS programs and game, packet in zip format.",
          category: "apps",
          link: "dosbox.html"
        },
        {
          name: "Explorer++",
          image: "box/explorer.jpg",
          description: "Gestor de archivos para Windows.",
          category: "utilities",
          link: "explorer.html"
        },
        {
          name: "7Zip",
          image: "box/7zip.jpg",
          description: "7-Zip is a file archiver with a high compression ratio. Download 7-Zip 24.08 (2024-08-11) for Windows x64 (64-bit).",
          category: "utilities",
          link: "zip.html"
        },
        {
          name: "Audacity",
          image: "box/audacity.jpg",
          description: "Audacity is the world's most popular audio editing and recording app. Edit, mix, and enhance your audio tracks with the power of Audacity.",
          category: "apps",
          link: "audacity.html"
        },
        {
          name: "Calc",
          image: "box/calc.png",
          description: "Calculator is a built-in WineBOX application that provides basic and advanced mathematical functions, including standard, scientific, programmer, and date calculations.",
          category: "utilities",
          link: "calc.html"
        },
        {
          name: "Calendar",
          image: "box/calendar.png",
          description: "Calendar is a WineBOX application that helps users manage schedules, create events, set reminders, and sync with online calendars for seamless planning.",
          category: "utilities",
          link: "calendar.html"
        },
        {
          name: "Clock",
          image: "box/clock.png",
          description: "Clock is a Windows application that provides alarms, timers, a stopwatch, and world time features to help users manage time efficiently.",
          category: "utilities",
          link: "clock.html"
        },
        {
          name: "Control",
          image: "box/control.png",
          description: "The Windows Control Panel is a tool that allows users to adjust system settings and customize hardware and software options.",
          category: "utilities",
          link: "control.html"
        },
        {
          name: "DOSShell",
          image: "box/dosshell.png",
          description: "A filemanager for MS-DOS.",
          category: "utilities",
          link: "dosshell.html"
        },
        {
          name: "Flat Assemblerl",
          image: "box/fasm.jpg",
          description: "Flat assembler is a free, multi-pass assembler with Intel-style syntax for the IA-32 and x86-64 architectures.",
          category: "apps",
          link: "fasm.html"
        },
        {
          name: "JPEGView",
          image: "box/jpegview.jpg",
          description: "JPEGView is a lean, fast and highly configurable viewer/editor for JPEG, BMP, PNG, WEBP, TGA, GIF and TIFF images with a minimal GUI.",
          category: "utilities",
          link: "jpegview.html"
        },        
       {
          name: "Media Player Classic",
          image: "box/mpc.png",
          description: "MPC-HC is an extremely light-weight, open source media player for Windows®. It supports all common video and audio file formats available for playback.",
          category: "apps",
          link: "mpc.html"
        },        
       {
          name: "Netsurf",
          image: "box/netsurf.jpg",
          description: "NetSurf is a multi-platform web browser for RISC OS, UNIX-like platforms (including Linux), Mac OS X, and more.",
          category: "apps",
          link: "netsurf.html"
        },     
       {
          name: "Notepad",
          image: "box/notepad.png",
          description: "MPC-HC is an extremely light-weight, open source media player for Windows®. It supports all common video and audio file formats available for playback.",
          category: "apps",
          link: "note.html"
        },        
       {
          name: "Notepad++",
          image: "box/npp.jpg",
          description: "Notepad++ is a free (as in “free speech” and also as in “free beer”) source code editor and Notepad replacement that supports several languages.",
          category: "apps",
          link: "npp.html"
        },       
       {
          name: "Paint",
          image: "box/paint.jpg",
          description: "Paint is a versatile and user-friendly graphics editing app in Windows for you to create, edit, and manipulate images and drawings.",
          category: "apps",
          link: "mspaint.html"
        },        
       {
          name: "Program Manager",
          image: "box/progman.png",
          description: "Program Manager is a graphical shell for managing applications and program groups in WineBOX. It allows users to organize, launch, and customize software shortcuts within a windowed interface.",
          category: "apps",
          link: "progman.html"
        },        
       {
          name: "Open Office",
          image: "box/soffice.jpg",
          description: "The Apache OpenOffice project announces the official release of version 4.1.15. In the Release Notes you can read about all new bugfixes, improvements.",
          category: "apps",
          link: "soffice.html"
        },
       {
          name: "Shell",
          image: "box/shell.png",
          description: "Command Prompt is a WineBOX command-line interpreter that allows users to execute commands, automate tasks, and manage system functions through text-based input.",
          category: "utilities",
          link: "shell.html"
        },   
       {
          name: "Sumatra PDF",
          image: "box/sumatra.jpg",
          description: "Sumatra PDF PDF, eBook (epub, mobi), comic book (cbz/cbr), DjVu, XPS, CHM, image viewer for Windows. Fast, small, packed with features, customizable, free.",
          category: "utilities",
          link: "sumatrapdf.html"
        },        
       {
          name: "TexWorks",
          image: "box/texworks.jpg",
          description: "A simple (La)TeX editor and PDF previewer that is available on all major desktop operating systems.",
          category: "apps",
          link: "texworks.html"
        },   
       {
          name: "ToDO",
          image: "box/todo.png",
          description: "To Do is a task management application that helps users create, organize, and track tasks with reminders, lists, and cloud synchronization.",
          category: "utilities",
          link: "todo.html"
        },   
       {
          name: "TurboC",
          image: "box/turboc.png",
          description: "Turbo C 2.01, a C compiler for MS-DOS.",
          category: "utilities",
          link: "turboc.html"
        },            
       {
          name: "TuxPaint",
          image: "box/tuxpaint.png",
          description: "Tux Paint is a free, award-winning drawing program for children ages 3 to 12 (for example, preschool and K-6).",
          category: "apps",
          link: "tuxpaint.html"
        },        
       {
          name: "UltraISO",
          image: "box/ultraiso.jpg",
          description: "Bootable CD/DVD creation is quick and simple with UltraISO - make a bootable CD or DVD and adapt it in any way you want.",
          category: "utilities",
          link: "ultraiso.html"
        },
       {
          name: "VirtualDUB",
          image: "box/virtualdub.jpg",
          description: "VirtualDub is a video capture/processing utility for 32-bit and 64-bit Windows platforms (98/ME/NT4/2000/XP/Vista/7), licensed under the GNU General Public.",
          category: "utilities",
          link: "virtualdub.html"
        },
       {
          name: "Winecfg",
          image: "box/winecfg.png",
          description: "Wine Settings for the Windows Emulation.",
          category: "utilities",
          link: "winecfg.html"
        },
       {
          name: "WineZIP",
          image: "box/winezip.png",
          description: "WineZip is an application that creates ZIP packages for installing Windows programs within WineBOX. It simplifies software deployment by packaging executable files and dependencies for seamless installation and execution.",
          category: "utilities",
          link: "winezip.html"
        },
       {
          name: "WinAMP",
          image: "box/winamp.jpg",
          description: "Winamp builds the tools that empower artists to manage their music and revenue while delivering a player that offers the perfect listening experience.",
          category: "apps",
          link: "winamp.html"
        },
       {
          name: "Wordpad",
          image: "box/wordpad.jpg",
          description: "WordPad is a word processor included with Windows 95 and later. Similarly to its predecessor Microsoft Write, it is a basic word processor.",
          category: "apps",
          link: "wordpad.html"
        },
        {
          name: "Arkanoid",
          image: "box/arkanoid.png",
          description: "Arkanoid is a block breaker video game. Its plot involves the starship Arkanoid being attacked by a mysterious entity from space named DOH. ",
          category: "arcade",
          link: "arkanoid.html"
        },
        {
          name: "Baby Type",
          image: "box/baby.jpg",
          description: "BabyType is a multi-language educational game aimed at teaching fast touch typing skills. ",
          category: "arcade",
          link: "babytype.html"
        },
        {
          name: "Baryon",
          image: "box/baryon.jpg",
          description: "Baryon is a straightforward vertical shooter which features a smooth graphical engine, a short digital sound track and various types of enemies.",
          category: "arcade",
          link: "baryon.html"
        },
        {
          name: "CD-MAN",
          image: "box/cdman.jpg",
          description: "CD-Man features 5 different worlds to pass each having nicely-drawn graphics in high-res EGA mode and therefore a new character.",
          category: "arcade",
          link: "cdman.html"
        },
        {
          name: "Dave",
          image: "box/dave.jpg",
          description: "Dangerous Dave in the Haunted Mansion is a famous and most played DOS game that now is available to play in browser. With virtual mobile controls you also can play in Dangerous Dave in the Haunted Mansion on mobile.",
          category: "arcade",
          link: "dave.html"
        },
        {
          name: "Disney Aladdin",
          image: "box/aladdin.jpg",
          description: "Disney's Aladdin is a famous and most played DOS game that now is available to play in browser. With virtual mobile controls you also can play in Disney's Aladdin on mobile.",
          category: "arcade",
          link: "aladdin.html"
        },
        {
          name: "Earthworm Jim",
          image: "box/jim.jpg",
          description: "Earthworm Jim is a famous and most played DOS game that now is available to play in browser. With virtual mobile controls you also can play in Earthworm Jim on mobile.",
          category: "arcade",
          link: "earthworm.html"
        },
        {
          name: "Golden Axe",
          image: "box/axe.jpg",
          description: "  Golden Axe is a side-scrolling, beat 'em up, hack and slash arcade video game released in 1989 by Sega for the System 16-B arcade hardware.",
          category: "arcade",
          link: "goldenaxe.html"
        },
        {
          name: "Out this world",
          image: "box/out.jpg",
          description: "Out of This World is a famous and most played DOS game that now is available to play in browser. With virtual mobile controls you also can play in Out of This World on mobile.",
          category: "arcade",
          link: "out.html"
        },
        {
          name: "Prince of persia",
          image: "box/pre1.jpg",
          description: "Prince of Persia is a 1989 cinematic platform game developed and published by Broderbund for the Apple II. It was designed and implemented by Jordan Mechner.",
          category: "arcade",
          link: "princeofpersia.html"
        },
        {
          name: "Prince of persia 2",
          image: "box/prince2.jpg",
          description: "Prince of Persia 2: The Shadow and the Flame is a platform game released by Brøderbund in 1993.",
          category: "arcade",
          link: "princeofpersia2.html"
        },
        {
          name: "Prehistorik",
          image: "box/spaceinvaders.png",
          description: "Prehistorik is a platform game developed by Titus Interactive for the Amiga, Atari ST, Amstrad CPC and DOS.",
          category: "arcade",
          link: "prehistorik.html"
        },
        {
          name: "Prehistorik 2",
          image: "box/pre2.jpg",
          description: "Prehistorik 2 is a platform game developed by Titus Interactive for the Amiga, Atari ST, Amstrad CPC and DOS.",
          category: "arcade",
          link: "prehistorik2.html"
        },
        {
          name: "Space Invaders",
          image: "box/spaceinvaders.png",
          description: "Icónico juego arcade de disparos espaciales.",
          category: "arcade",
          link: "spaceinvaders.html"
        },
        {
          name: "The Lost Vikings",
          image: "box/vikings.jpg",
          description: "In the game, the three Vikings get kidnapped by Tomator, emperor of the alien Croutonian empire, for an inter-galactic zoo and become lost in various periods.",
          category: "arcade",
          link: "vikings.html"
        },
        {
          name: "XBill",
          image: "box/xbill.webp",
          description: "XBill is an arcade style game for the X Window System. The game features a bespectacled character known as Bill.",
          category: "arcade",
          link: "xbill.html"
        },
        {
          name: "Oregon Trail Delux",
          image: "box/oregon.jpg",
          description: "You get to play the role of a wagon leader and guide your group of chosen settlers from Independence, Missouri, to the Willamette Valley in Oregon.",
          category: "rts",
          link: "oregon.html"
        },
        {
          name: "Heroes of Might and Magic II",
          image: "box/heroes2.jpg",
          description: "The canonical ending of Heroes I results in Lord Morglin Ironfist’s victory. In the following years, he has successfully unified the continent of Enroth and secured his rule as king.",
          category: "rts",
          link: "heroes.html"
        },
        {
          name: "Warcraft",
          image: "box/war1.jpg",
          description: "Warcraft: Orcs & Humans is a real-time strategy game (RTS) developed and published by Blizzard Entertainment, and published by Interplay Productions in Europe.",
          category: "rts",
          link: "warcraft.html"
        },
        {
          name: "Warcraft II",
          image: "box/war2.jpg",
          description: "WarCraft II: Tides of Darkness is a sequel to WarCraft: Orcs & Humans strategy game for DOS.",
          category: "rts",
          link: "warcraft2.html"
        },
        {
          name: "Command & Conquer",
          image: "box/command.jpg",
          description: "Wage real-time war in more ways than ever with a modern and near-future arsenal. Command the powerful US forces.",
          category: "rts",
          link: "commandconquer.html"
        },
        {
          name: "Rise of the triad",
          image: "box/rise.webp",
          description: "Rise of the Triad: Dark War is a famous and most played DOS game that now is available to play in browser. With virtual mobile controls you also can play in Rise of the Triad: Dark War on mobile. On DOS.Zone Rise of the Triad: Dark War available to play for free without registration.",
          category: "rts",
          link: "rise.html"
        },
        {
          name: "Sim City",
          image: "box/simcity.jpg",
          description: "SimCity is an open-ended city-building video game franchise originally designed by Will Wright.",
          category: "rts",
          link: "simcity.html"
        },
        {
          name: "Sim City 2000",
          image: "box/sim2000.jpg",
          description: "SimCity 2000 marked a major shift in gameplay from the original SimCity, the basic structure set forth in this seminal version has defined subsequent releases.",
          category: "rts",
          link: "simcity2000.html"
        },
        {
          name: "X-COM: UFO Defense",
          image: "box/xcom.jpg",
          description: "Shooting down UFOs is just the beginning: you must then lead a squad of heavily-armed soldiers across different terrains as they investigate the UFO crash site.",
          category: "rts",
          link: "xcom.html"
        },
        {
          name: "Master of Orion II",
          image: "box/master.jpg",
          description: "Forge an empire in a universe where population growth is stripping away planetary resources. Colonize unknown planets and trade.",
          category: "rts",
          link: "masteroforion.html"
        }

      ];
      //////////////////////////////////////////////////////////////////

      // Variables para control de navegación
      const MAX_RECENT_APPS = 16;
      let currentSelectedIndex = -1;
      let currentApps = [];
      let isModalOpen = false;
      let joystickConnected = false;
      let recentApps = JSON.parse(localStorage.getItem('recentApps')) || [];
      let currentFocusArea = 'recent';
      let currentCategoryIndex = 0;
      let currentRecentIndex = -1;
      let isScrolling = false;

      // Elementos del DOM
      const appGrid = document.getElementById('appGrid');
      const recentAppsContainer = document.getElementById('recentApps');
      const selectedAppInfo = document.getElementById('selectedAppInfo');
      const joystickButton = document.getElementById('joystickButton');
      const categoryButtons = document.querySelectorAll('.category-button');
      const navSound = document.getElementById('navSound');
      const scrollIndicator = document.getElementById('scrollIndicator');
      const recentAppsEl = document.getElementById('recentApps');
      const joystickDialog = document.getElementById('joystickDialog');
      const joystickStatusText = document.getElementById('joystickStatusText');
      const connectJoystickBtn = document.getElementById('connectJoystickBtn');
      const joystickTypes = document.getElementById('joystickTypes');
      const joystickPreview = document.getElementById('joystickPreview');
      const joystickClose = document.querySelector('.joystick-close');

      // Función para mostrar aplicaciones recientes
      function displayRecentApps() {
        recentAppsContainer.innerHTML = '';
        
        if (recentApps.length === 0) {
          recentAppsContainer.innerHTML = '<p style="color: #666; padding: 10px;">No recent apps</p>';
          return;
        }
        
        recentApps.forEach((app, index) => {
          const appInData = appData.find(a => a.name === app.name) || app;
          const appWrapper = document.createElement('div');
          appWrapper.style.position = 'relative';
          appWrapper.style.display = 'inline-block';
          
          const img = document.createElement('img');
          img.src = appInData.image || 'box/default.png';
          img.className = 'recent-app';
          img.title = appInData.name;
          img.dataset.index = index;
          img.dataset.appName = appInData.name;
          
          const infoDiv = document.createElement('div');
          infoDiv.className = 'selected-app-info';
          infoDiv.textContent = appInData.name;
          
          img.addEventListener('click', () => launchRecentApp(appInData));
          
          appWrapper.appendChild(img);
          appWrapper.appendChild(infoDiv);
          recentAppsContainer.appendChild(appWrapper);
        });

        if (recentApps.length > 0 && currentFocusArea === 'recent') {
          currentRecentIndex = 0;
          updateSelection();
        }
        
        setTimeout(updateScrollIndicator, 100);
      }

      // Función para mostrar aplicaciones
      function displayApps(apps) {
        appGrid.innerHTML = '';
        currentApps = apps;
        
        if (apps.length === 0) {
          appGrid.innerHTML = '<p style="color: #666; grid-column: 1/-1; text-align: center;">No apps found</p>';
          return;
        }
        
        apps.forEach((app, index) => {
          const appCard = document.createElement('div');
          appCard.classList.add('app-card');
          if (index === currentSelectedIndex && currentFocusArea === 'apps') {
            appCard.classList.add('selected');
          }
          
          appCard.innerHTML = `
            <img src="${app.image}" alt="${app.name}" class="app-thumbnail">
            <div class="app-info">
              <div class="app-title">${app.name}</div>
              <div class="app-category">${app.category}</div>
            </div>
          `;
          
          appCard.addEventListener('click', () => {
            openAppModal(app);
            addToRecentApps(app);
          });
          
          appGrid.appendChild(appCard);
        });

        if (currentApps.length > 0 && currentSelectedIndex === -1 && currentFocusArea === 'apps') {
          currentSelectedIndex = 0;
          updateSelection();
        }
      }

      // Función para actualizar selección
      function updateSelection() {
        const recentAppElements = document.querySelectorAll('.recent-app');
        
        recentAppElements.forEach((element, index) => {
          if (index === currentRecentIndex && currentFocusArea === 'recent') {
            element.classList.add('selected');
            const appName = element.dataset.appName;
            selectedAppInfo.textContent = appName;
            selectedAppInfo.style.left = `${element.offsetLeft}px`;
            selectedAppInfo.style.width = `${element.offsetWidth}px`;
            element.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
          } else {
            element.classList.remove('selected');
          }
        });

        categoryButtons.forEach((button, index) => {
          if (index === currentCategoryIndex && currentFocusArea === 'categories') {
            button.classList.add('selected');
            button.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          } else {
            button.classList.remove('selected');
          }
        });

        const appCards = document.querySelectorAll('.app-card');
        appCards.forEach((card, index) => {
          if (index === currentSelectedIndex && currentFocusArea === 'apps') {
            card.classList.add('selected');
            card.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          } else {
            card.classList.remove('selected');
          }
        });
      }

      // Función para agregar a recientes
      function addToRecentApps(app) {
        recentApps = recentApps.filter(a => a.name !== app.name);
        recentApps.unshift({
          name: app.name,
          image: app.image,
          link: app.link
        });
        
        if (recentApps.length > MAX_RECENT_APPS) {
          recentApps = recentApps.slice(0, MAX_RECENT_APPS);
        }
        
        localStorage.setItem('recentApps', JSON.stringify(recentApps));
        displayRecentApps();
      }

      // Función para abrir modal de aplicación
      function openAppModal(app) {
        isModalOpen = true;
        const appDetails = document.getElementById('appDetails');
        const modal = document.getElementById('appModal');

        appDetails.innerHTML = `
          <h2>${app.name}</h2>
          <img src="${app.image}" alt="${app.name}" style="max-width: 200px;">
          <p><strong>Categoría:</strong> ${app.category}</p>
          <p><strong>Descripción:</strong> ${app.description}</p>
        `;

        const launchButton = document.getElementById('launchButton');
        launchButton.onclick = () => {
          location.href = app.link;
          addToRecentApps(app);
        };

        modal.style.display = 'block';
        currentSelectedIndex = -1;
      }

      // Función para cerrar modal
      function closeModal() {
        isModalOpen = false;
        document.getElementById('appModal').style.display = 'none';
        if (currentApps.length > 0 && currentFocusArea === 'apps') {
          currentSelectedIndex = Math.min(currentSelectedIndex, currentApps.length - 1);
          updateSelection();
        }
      }

      // Funciones de navegación con teclado
      function handleUpArrow() {
        if (currentFocusArea === 'apps' && currentApps.length > 0) {
          const columns = Math.floor(appGrid.offsetWidth / (200 + 20));
          if (currentSelectedIndex >= columns) {
            currentSelectedIndex -= columns;
            updateSelection();
          } else {
            currentFocusArea = 'categories';
            currentCategoryIndex = Math.min(currentCategoryIndex, categoryButtons.length - 1);
            updateSelection();
          }
        } else if (currentFocusArea === 'categories') {
          currentFocusArea = 'recent';
          if (recentApps.length > 0) {
            currentRecentIndex = 0;
            updateSelection();
          }
        }
      }

      function handleDownArrow() {
        if (currentFocusArea === 'recent') {
          currentFocusArea = 'categories';
          currentCategoryIndex = Math.min(currentCategoryIndex, categoryButtons.length - 1);
          updateSelection();
        } else if (currentFocusArea === 'categories') {
          currentFocusArea = 'apps';
          currentSelectedIndex = Math.min(currentSelectedIndex, currentApps.length - 1);
          if (currentSelectedIndex === -1 && currentApps.length > 0) {
            currentSelectedIndex = 0;
          }
          updateSelection();
        } else if (currentFocusArea === 'apps' && currentApps.length > 0) {
          const columns = Math.floor(appGrid.offsetWidth / (200 + 20));
          if (currentSelectedIndex + columns < currentApps.length) {
            currentSelectedIndex += columns;
            updateSelection();
          }
        }
      }

      function handleLeftArrow() {
        if (currentFocusArea === 'recent' && recentApps.length > 0) {
          if (currentRecentIndex > 0) {
            currentRecentIndex--;
            updateSelection();
          }
        } else if (currentFocusArea === 'categories') {
          if (currentCategoryIndex > 0) {
            currentCategoryIndex--;
            updateSelection();
          }
        } else if (currentFocusArea === 'apps' && currentApps.length > 0) {
          if (currentSelectedIndex > 0) {
            currentSelectedIndex--;
            updateSelection();
          }
        }
      }

      function handleRightArrow() {
        if (currentFocusArea === 'recent' && recentApps.length > 0) {
          if (currentRecentIndex < recentApps.length - 1) {
            currentRecentIndex++;
            updateSelection();
          }
        } else if (currentFocusArea === 'categories') {
          if (currentCategoryIndex < categoryButtons.length - 1) {
            currentCategoryIndex++;
            updateSelection();
          }
        } else if (currentFocusArea === 'apps' && currentApps.length > 0) {
          if (currentSelectedIndex < currentApps.length - 1) {
            currentSelectedIndex++;
            updateSelection();
          }
        }
      }

      function handleEnter() {
        if (currentFocusArea === 'recent' && currentRecentIndex >= 0 && currentRecentIndex < recentApps.length) {
          const recentApp = recentApps[currentRecentIndex];
          const fullAppData = appData.find(a => a.name === recentApp.name) || recentApp;
          launchRecentApp(fullAppData);
        } else if (currentFocusArea === 'categories' && currentCategoryIndex >= 0 && currentCategoryIndex < categoryButtons.length) {
          categoryButtons[currentCategoryIndex].click();
          currentFocusArea = 'apps';
          currentSelectedIndex = 0;
          updateSelection();
        } else if (currentFocusArea === 'apps' && currentSelectedIndex >= 0 && currentSelectedIndex < currentApps.length) {
          openAppModal(currentApps[currentSelectedIndex]);
        }
      }

      function toggleFocusArea() {
        if (currentFocusArea === 'recent') {
          currentFocusArea = 'categories';
          currentCategoryIndex = Math.min(currentCategoryIndex, categoryButtons.length - 1);
        } else if (currentFocusArea === 'categories') {
          currentFocusArea = 'apps';
          if (currentApps.length > 0) {
            currentSelectedIndex = 0;
          }
        } else if (currentFocusArea === 'apps') {
          currentFocusArea = 'recent';
          if (recentApps.length > 0) {
            currentRecentIndex = 0;
          }
        }
        updateSelection();
      }

      // Función para lanzar aplicación reciente
      function launchRecentApp(app) {
        location.href = app.link;
        addToRecentApps(app);
      }

      // Función para actualizar visibilidad del indicador de scroll
      function updateScrollIndicator() {
        const isAtEnd = recentAppsEl.scrollWidth <= recentAppsEl.scrollLeft + recentAppsEl.clientWidth + 1;
        scrollIndicator.style.display = isAtEnd ? 'none' : 'flex';
      }

      // Función para reproducir sonido de navegación
      function playNavSound() {
        if (navSound) {
          navSound.currentTime = 0;
          navSound.play().catch(e => console.log("Audio play failed:", e));
        }
      }

      // Función para actualizar estado del joystick
      function updateJoystickStatus() {
        const gamepads = navigator.getGamepads ? navigator.getGamepads() : [];
        const isConnected = gamepads.some(g => g && g.connected);
        
        if (isConnected) {
          joystickStatusText.textContent = 'Control detectado y conectado.';
          connectJoystickBtn.style.display = 'none';
          joystickTypes.style.display = 'none';
        } else {
          joystickStatusText.textContent = 'No se detectó ningún control conectado.';
          connectJoystickBtn.style.display = 'block';
        }
      }

      // Función para escanear joystick
      function scanJoystick() {
        if (!joystickConnected || isModalOpen) return;
        
        const gamepad = navigator.getGamepads()[0];
        if (!gamepad) return;

        const now = Date.now();
        if (now - lastJoystickMove < joystickMoveDelay) return;

        const axisX = gamepad.axes[0];
        const axisY = gamepad.axes[1];
        const threshold = 0.5;

        if (axisX < -threshold) {
          lastJoystickMove = now;
          playNavSound();
          handleLeftArrow();
        } else if (axisX > threshold) {
          lastJoystickMove = now;
          playNavSound();
          handleRightArrow();
        } else if (axisY < -threshold) {
          lastJoystickMove = now;
          playNavSound();
          handleUpArrow();
        } else if (axisY > threshold) {
          lastJoystickMove = now;
          playNavSound();
          handleDownArrow();
        }

        if (gamepad.buttons[0].pressed) {
          playNavSound();
          handleEnter();
        }

        if (gamepad.buttons[1].pressed) {
          playNavSound();
          if (isModalOpen) {
            closeModal();
          } else if (currentFocusArea === 'apps' && currentSelectedIndex >= 0) {
            currentSelectedIndex = -1;
            currentFocusArea = 'categories';
            updateSelection();
          } else if (currentFocusArea === 'categories') {
            currentFocusArea = 'recent';
            if (recentApps.length > 0) {
              currentRecentIndex = 0;
            }
            updateSelection();
          }
        }
      }

      // Eventos
      document.addEventListener('keydown', (e) => {
        if (isModalOpen) {
          if (e.key === 'Escape') {
            closeModal();
          } else if (e.key === 'Enter') {
            document.getElementById('launchButton').click();
          }
          return;
        }

        switch(e.key) {
          case 'ArrowUp':
            e.preventDefault();
            playNavSound();
            handleUpArrow();
            break;
          case 'ArrowDown':
            e.preventDefault();
            playNavSound();
            handleDownArrow();
            break;
          case 'ArrowLeft':
            e.preventDefault();
            playNavSound();
            handleLeftArrow();
            break;
          case 'ArrowRight':
            e.preventDefault();
            playNavSound();
            handleRightArrow();
            break;
          case 'Enter':
            e.preventDefault();
            playNavSound();
            handleEnter();
            break;
          case 'Tab':
            e.preventDefault();
            playNavSound();
            toggleFocusArea();
            break;
        }
      });

      scrollIndicator.addEventListener('click', () => {
        recentAppsEl.scrollBy({
          left: 200,
          behavior: 'smooth'
        });
        setTimeout(updateScrollIndicator, 300);
      });

      recentAppsEl.addEventListener('scroll', () => {
        if (!isScrolling) {
          isScrolling = true;
          setTimeout(() => {
            updateScrollIndicator();
            isScrolling = false;
          }, 100);
        }
      });

      joystickButton.addEventListener('click', () => {
        updateJoystickStatus();
        joystickDialog.style.display = 'block';
      });

      joystickClose.addEventListener('click', () => {
        joystickDialog.style.display = 'none';
      });

      connectJoystickBtn.addEventListener('click', () => {
        joystickTypes.style.display = 'block';
        connectJoystickBtn.style.display = 'none';
      });

      document.querySelectorAll('.joystick-type-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const type = this.dataset.type;
          joystickPreview.innerHTML = `
            <div style="height:300px;display:flex;align-items:center;justify-content:center;color:#aaa;">
              Vista previa del control ${type.charAt(0).toUpperCase() + type.slice(1)}
            </div>`;
          joystickPreview.style.display = 'block';
        });
      });

      categoryButtons.forEach((button, index) => {
        button.addEventListener('click', () => {
          categoryButtons.forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');
          const category = button.dataset.category;
          const filteredApps = category === 'all' ? appData : appData.filter(app => app.category === category);
          displayApps(filteredApps);
          currentSelectedIndex = 0;
          currentFocusArea = 'apps';
          updateSelection();
        });
      });

      const searchInput = document.querySelector('.search-input');
      const searchButton = document.querySelector('.search-button');

      searchButton.addEventListener('click', () => {
        const query = searchInput.value.trim();
        if (query) {
          const filteredApps = appData.filter(app => 
            app.name.toLowerCase().includes(query.toLowerCase()) || 
            app.description.toLowerCase().includes(query.toLowerCase())
          );
          displayApps(filteredApps);
          currentSelectedIndex = 0;
          currentFocusArea = 'apps';
          updateSelection();
        }
      });

      searchInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          const query = searchInput.value.trim();
          if (query) {
            const filteredApps = appData.filter(app => 
              app.name.toLowerCase().includes(query.toLowerCase()) || 
              app.description.toLowerCase().includes(query.toLowerCase())
            );
            displayApps(filteredApps);
            currentSelectedIndex = 0;
            currentFocusArea = 'apps';
            updateSelection();
          }
        }
      });

      const closeBtn = document.querySelector('.close');
      const modal = document.getElementById('appModal');

      closeBtn.onclick = closeModal;

      window.onclick = function(event) {
        if (event.target == modal) {
          closeModal();
        }
        if (event.target == joystickDialog) {
          joystickDialog.style.display = 'none';
        }
      }

      const sidebarIcons = document.querySelectorAll('.sidebar-icon');
      sidebarIcons.forEach((icon, index) => {
        icon.addEventListener('click', () => {
          switch(index) {
            case 0:
              displayApps(appData);
              break;
            case 1:
              displayApps(appData.filter(app => app.category === 'apps'));
              break;
            case 2:
              displayApps(appData.filter(app => app.category === 'games'));
              break;
            case 3:
              displayApps(appData.filter(app => app.category === 'arcade'));
              break;
          }
          currentSelectedIndex = 0;
          currentFocusArea = 'apps';
          updateSelection();
        });
      });

      // Detección de joystick
      function checkJoystick() {
        const gamepads = navigator.getGamepads ? navigator.getGamepads() : [];
        const wasConnected = joystickConnected;
        joystickConnected = false;
        
        for (let i = 0; i < gamepads.length; i++) {
          if (gamepads[i] && gamepads[i].connected) {
            joystickConnected = true;
            break;
          }
        }
        
        if (joystickConnected !== wasConnected) {
          joystickButton.className = joystickConnected ? 
            'joystick-button connected' : 
            'joystick-button';
          
          if (joystickDialog.style.display === 'block') {
            updateJoystickStatus();
          }
        }
      }

      let joystickInterval;
      let lastJoystickMove = 0;
      const joystickMoveDelay = 300;

      window.addEventListener('gamepadconnected', (e) => {
        joystickConnected = true;
        joystickButton.className = 'joystick-button connected';
        clearInterval(joystickInterval);
        joystickInterval = setInterval(scanJoystick, 50);
      });

      window.addEventListener('gamepaddisconnected', (e) => {
        joystickConnected = false;
        joystickButton.className = 'joystick-button';
        clearInterval(joystickInterval);
      });

      // Inicialización
      setInterval(checkJoystick, 1000);
      checkJoystick();

      displayApps(appData);
      displayRecentApps();
      
      if (recentApps.length > 0) {
        currentRecentIndex = 0;
        updateSelection();
      }
    });
  </script>
</body>
</html>